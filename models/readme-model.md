# datasets introduction
- **mySlideDataset.py**: 
- **myTileDataset.py**: data pool for image tiles, output is original image tiles and corresponding prior images


## Ours (prompts and confounders p(y|do(x)))
- **Vision prompts based on prior image**
    - **G(prior):** generate prompts from prior segmentation image directly
        - **model_v3**: nuclei image prompt @ white image prompt
        - **model_v31**: apply prompt generator (encoder+decoder) to (priorSeg )
        - **model_v32**: original image prompt @ nuclei image prompt @ white image prompt
    - **G(Q(prior)):** learn prompts from quantitative attributes extracted from prior segmentation image
        - **model_v33**: project and generate prompts directly
        - **model_v34**: generate cooeficients and multify it with parameters embeddings (dictionary), resulting prompts
        - **model_v35**: dictionary + gate
        - `**model_v36**`: using self attention (encoder+decoder) to generate prompts. (BEST)
        - **model_v361**: based on model_v36, enable calculate mean value of a distribution (requrest by reviewer)
        - **model_v37**: using self attention (encoder only) to generate prompts
        - **model_v39**: apply prompt generator (encoder+decoder) to (priorSeg + quantitative attributes)
        using matrix factorization to generate prompts

- **Vision-driven prompts generated by original image using visoin model (SAM)**
    - **model_v4** : SAM-based method:
    - **model_v41**: HistoML-based method: segmentation --> detection -> quantitative analysis

- **Language-driven prompts generated by original image using LLM (VQA)**
    - **model_v5**

## Key libs
- **promptEncoder.py**: custom prompt generator
- **vision_transformer.py**: the lib to build VPT
- **vqt_vit.py**: the lib to build VQT
- **custom_vqt_vit.py**: develop based on 'vqt_vit.py', to implement VQT + quantitative attribtues
- **vision_transformer_custom.py** develop based on 'vision_transformer.py', to implement VQT + quantitative attributes


# Key function operators
## ~/utils/
    - **spatial_statistics.py**
        - calculate_segmentation_properties(): only return properties of max area region
        - calculate_segmentation_properties_histogram(): return 10 bins histogram
        - calculate_k_function(): return 140 length K(r)

    - **generate_props.py**
    - **analysis_props.py**



## ~/models/promptEncoders.py
    - promptSAT: using official transformerencoderlayer
    - promptEncoderDecoder: using decoder to generate prompts
    



 